#!/usr/bin/env python

import math
import matplotlib.pyplot as plt

def one_over_x(x, a, b): return 1 / (a * x + b)
def one_over_x_squared(x, a, b, c): return 1 / (a * math.pow(x, 2) + b * x + c)
def one_over_x_to_the_k(x, a, b, k): return 1 / (a * math.pow(x, k) + b)

def plot(call_func, x, y, extra_x, extra_y, nice_string, *params):
  x = x[40:]; y = y[40:]
  fitted_y = [call_func(xx) for xx in x + extra_x]
  fig = plt.figure()
  ax = fig.add_subplot(1, 1, 1)
  ax.plot(x, y, "x", label="orig")
  ax.plot(x + extra_x, fitted_y, label="fitted")
  ax.plot(extra_x, extra_y, "x", label="future")
  ax.set_xlabel("Iteration")
  ax.set_ylabel("Loss")
  ax.text(10, 0.75, nice_string)
  plt.savefig("output.png")

def main():
  (a, b, c) = (0.006907605771071532, -0.2954079245314737, 3.0917521545380082)
  x = [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0, 25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0, 37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0, 48.0, 49.0]
  y = [0.8298160792195828, 0.6925252153913596, 0.6920100499363546, 0.6919793192876244, 0.691852212612796, 0.6915696186839926, 0.69081602037653, 0.689080327461678, 0.6855736625087322, 0.6807537655511823, 0.667048570262496, 0.6381420927175953, 0.6218858965335436, 0.5940733914315439, 0.5718304288280405, 0.5713272492170728, 0.5689950323429458, 0.5622575156833408, 0.547539385582486, 0.5207554554907012, 0.4573655040665938, 0.39099156769153515, 0.3728753789983046, 0.35993838961343394, 0.3592222900749839, 0.3582880709125961, 0.35270551559137814, 0.3427632836421802, 0.32869326396951243, 0.3159228705149795, 0.30916418329574624, 0.3075759797370771, 0.30735529610721296, 0.3070570067098703, 0.3053525175760029, 0.30338782906114997, 0.3009224499646084, 0.2923418021633638, 0.28936849771347767, 0.2877260781040641, 0.28699866309718564, 0.28560123980866203, 0.2829604966318255, 0.2791220277812717, 0.2738638821751554, 0.26948927339974055, 0.26895418319932135, 0.26857549125400487, 0.2683652481269675, 0.267696249332297]
  extra_x = [50, 51, 52, 53, 54]
  extra_y = [0.26692680246365347, 0.2663976092188838, 0.2654293269050549, 0.26403606894952786, 0.26293287102810226]
  call_func = lambda x: one_over_x_squared(x, a, b, c)
  nice_string = "1 / (ax^2 + bx + c)\na = %s\nb = %s\nc = %s" % (a, b, c)
  plot(call_func, x, y, extra_x, extra_y, nice_string, a, b, c)

if __name__ == "__main__":
  main()

